<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Data Receiver</title>
</head>
<body>
    <div id="messageContainer"></div>

    <script>
        // Function to create a WebSocket connection
        function setupWebSocket() {
            // WebSocket URL - Replace with your WebSocket server URL
            const socketURL = 'ws://35.186.191.80:8080/';

            // Create a WebSocket connection
            const socket = new WebSocket(socketURL);
            function decodeJsonBinary(encodedData) {
              // Convert the encoded data to a Uint8Array
              const binaryData = new Uint8Array(encodedData);
              console.log(`binary ${binaryData}`)

              // Decode the binary data as a string
              const decodedString = new TextDecoder().decode(binaryData);
              console.log(`decoded ${decodedString}`)

              // Parse the decoded string as JSON
              const decodedJson = JSON.parse(decodedString);

              return decodedJson;
            }

            // Handle incoming messages
            socket.addEventListener('message', (event) => {
                console.log(`event ${event}`)
                data = event.data
                console.log(`data[0]: ${data[0]}`)
                console.log(`data[0]: ${data[0]}`)
                console.log(`data type: ${Object.prototype.toString.apply(data)}`)
                console.log(`data ${data}`)
                parsed = JSON.parse(data)
                console.log(`parsed ${parsed}`)
                displayMessage(JSON.stringify(parsed));
            });

            // Function to display messages on the HTML page
            function displayMessage(message) {
                const messageContainer = document.getElementById('messageContainer');
                const messageElement = document.createElement('pre');
                messageElement.textContent = message;
                messageContainer.appendChild(messageElement);
            }
        }

        // Call the setupWebSocket function to initiate the WebSocket connection
        setupWebSocket();
    </script>
</body>
</html>
